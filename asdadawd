wait(1)

local UILib = {}

function UILib:CreateUI(title)
    local TweenService = game:GetService("TweenService")
    local Players = game:GetService("Players")
    local LOCAL = Players.LocalPlayer

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "SellingGui"
    screenGui.Parent = LOCAL:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false

    if getgenv().Settings and getgenv().Settings.Main and getgenv().Settings.Main.SmallGui then
        local scale = Instance.new("UIScale")
        scale.Scale = 0.67
        scale.Parent = screenGui
    end

    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Parent = screenGui
    mainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
    mainFrame.Size = UDim2.new(0, 625, 0, 400)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = false
    mainFrame.BackgroundTransparency = 1
    mainFrame.Size = UDim2.new(0, 1, 0, 1)

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 12)
    mainCorner.Parent = mainFrame

    -- PURPLE GRADIENT OVERLAY
    local gradientOverlay = Instance.new("Frame")
    gradientOverlay.Name = "GradientOverlay"
    gradientOverlay.Parent = mainFrame
    gradientOverlay.Size = UDim2.new(1, 0, 1, 0)
    gradientOverlay.Position = UDim2.new(0, 0, 0, 0)
    gradientOverlay.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    gradientOverlay.BorderSizePixel = 0
    gradientOverlay.ZIndex = 0
    gradientOverlay.Active = false

    local gradientCorner = Instance.new("UICorner")
    gradientCorner.CornerRadius = UDim.new(0, 12)
    gradientCorner.Parent = gradientOverlay

    local bgGradient = Instance.new("UIGradient")
    bgGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(15, 15, 15)),
        ColorSequenceKeypoint.new(0.4, Color3.fromRGB(18, 12, 25)),
        ColorSequenceKeypoint.new(0.7, Color3.fromRGB(30, 15, 45)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(50, 20, 75))
    })
    bgGradient.Rotation = 90
    bgGradient.Parent = gradientOverlay

    local stroke = Instance.new("UIStroke", mainFrame)
    stroke.Color = Color3.fromRGB(120, 50, 180)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.3

    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.Parent = mainFrame
    shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    shadow.Position = UDim2.new(0.5, 0, 0.5, 6)
    shadow.Size = UDim2.new(1, 20, 1, 20)
    shadow.BackgroundTransparency = 1
    shadow.ZIndex = -1
    shadow.Image = "rbxassetid://1316045217"
    shadow.ImageColor3 = Color3.fromRGB(60, 20, 100)
    shadow.ImageTransparency = 0.5
    shadow.ScaleType = Enum.ScaleType.Slice
    shadow.SliceCenter = Rect.new(10, 10, 118, 118)

    task.spawn(function()
        TweenService:Create(mainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 625, 0, 400)
        }):Play()
    end)

    local dragToggle, dragStart, startPos
    local dragSpeed = 0.5
    local UIS = game:GetService("UserInputService")

    local function updateInput(input)
        local delta = input.Position - dragStart
        local position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
        TweenService:Create(mainFrame, TweenInfo.new(dragSpeed), { Position = position }):Play()
    end

    -- Header frame para drag solo en cabecera
    local headerFrame = Instance.new("Frame")
    headerFrame.Name = "HeaderFrame"
    headerFrame.Parent = mainFrame
    headerFrame.Size = UDim2.new(1, 0, 0, 50)
    headerFrame.Position = UDim2.new(0, 0, 0, 0)
    headerFrame.BackgroundTransparency = 1
    headerFrame.ZIndex = 10

    headerFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragToggle = true
            dragStart = input.Position
            startPos = mainFrame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragToggle = false
                end
            end)
        end
    end)

    UIS.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            if dragToggle then
                updateInput(input)
            end
        end
    end)

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "TitleLabel"
    titleLabel.Parent = mainFrame
    titleLabel.Text = title
    titleLabel.BackgroundTransparency = 1
    titleLabel.Size = UDim2.new(1, 0, 0, 40)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 22
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextYAlignment = Enum.TextYAlignment.Center
    titleLabel.TextXAlignment = Enum.TextXAlignment.Center
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.ZIndex = 2

    local titleGradient = Instance.new("UIGradient")
    titleGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(220, 130, 255)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(170, 70, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(130, 40, 200))
    })
    titleGradient.Parent = titleLabel

    local titleGlow = Instance.new("UIStroke")
    titleGlow.Parent = titleLabel
    titleGlow.Color = Color3.fromRGB(170, 80, 255)
    titleGlow.Thickness = 1.5
    titleGlow.Transparency = 0.4

    local divider = Instance.new("Frame", mainFrame)
    divider.Size = UDim2.new(1, -32, 0, 1)
    divider.Position = UDim2.new(0, 16, 0, 44)
    divider.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    divider.BackgroundTransparency = 0.2
    divider.BorderSizePixel = 0
    divider.ZIndex = 2

    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Parent = mainFrame
    minimizeButton.Size = UDim2.new(0, 30, 0, 30)
    minimizeButton.Position = UDim2.new(1, -40, 0, 6)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(35, 20, 50)
    minimizeButton.AutoButtonColor = false
    minimizeButton.Text = "-"
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.TextSize = 22
    minimizeButton.ZIndex = 3
    minimizeButton.BorderSizePixel = 0

    local minCorner = Instance.new("UICorner", minimizeButton)
    minCorner.CornerRadius = UDim.new(0, 6)

    local minStroke = Instance.new("UIStroke", minimizeButton)
    minStroke.Color = Color3.fromRGB(80, 40, 120)
    minStroke.Thickness = 1
    minStroke.Transparency = 0.4

    local isMinimized = false
    minimizeButton.MouseButton1Click:Connect(function()
        isMinimized = not isMinimized

        local targetSize = isMinimized and UDim2.new(0, 625, 0, 40) or UDim2.new(0, 625, 0, 400)
        minimizeButton.Text = isMinimized and "+" or "-"
        TweenService:Create(mainFrame, TweenInfo.new(0.3), { Size = targetSize }):Play()

        for _, v in ipairs(mainFrame:GetChildren()) do
            if v ~= minimizeButton and v ~= titleLabel and v ~= mainCorner and v ~= shadow and v ~= stroke and v ~= gradientOverlay and v ~= headerFrame then
                v.Visible = not isMinimized
            end
        end
        shadow.Visible = true
        gradientOverlay.Visible = true
    end)

    -- Contenedor para las pestañas
    local tabContainer = Instance.new("Frame")
    tabContainer.Name = "TabContainerBG"
    tabContainer.Parent = mainFrame
    tabContainer.Size = UDim2.new(0, 145, 1, -60)
    tabContainer.Position = UDim2.new(0, 5, 0, 52)
    tabContainer.BackgroundColor3 = Color3.fromRGB(35, 25, 50)
    tabContainer.BorderSizePixel = 0
    tabContainer.ZIndex = 2

    local tabContainerCorner = Instance.new("UICorner")
    tabContainerCorner.CornerRadius = UDim.new(0, 10)
    tabContainerCorner.Parent = tabContainer

    local tabContainerStroke = Instance.new("UIStroke")
    tabContainerStroke.Parent = tabContainer
    tabContainerStroke.Color = Color3.fromRGB(90, 60, 130)
    tabContainerStroke.Thickness = 1
    tabContainerStroke.Transparency = 0.5

    local tabScrollFrame = Instance.new("ScrollingFrame")
    tabScrollFrame.Name = "TabScrollFrame"
    tabScrollFrame.Parent = tabContainer
    tabScrollFrame.Size = UDim2.new(1, -10, 1, -10)
    tabScrollFrame.Position = UDim2.new(0, 5, 0, 5)

    local tabContainer = Instance.new("ScrollingFrame")
    tabContainer.Name = "TabContainer"
    tabContainer.Parent = mainFrame
    tabContainer.Size = UDim2.new(1, -150, 1, -50)
    tabContainer.Position = UDim2.new(0, 150, 0, 50)
    tabContainer.BackgroundTransparency = 1
    tabContainer.ScrollBarThickness = 0
    tabContainer.ZIndex = 2
    tabContainer.ScrollBarImageTransparency = 1
    tabContainer.CanvasSize = UDim2.new(0, 0, 0, 0)

    local tabs = Instance.new("Folder")
    tabs.Name = "Tabs"
    tabs.Parent = tabContainer

    return setmetatable({
        GUI = screenGui,
        MainFrame = mainFrame,
        Tabs = tabs,
        TabButtons = {},
        TabScrollFrame = tabScrollFrame
    }, { __index = UILib })
end

function UILib:Toggle()
    self.MainFrame.Visible = not self.MainFrame.Visible
end

function UILib:AddTab(name, decalID)
    local tab = Instance.new("ScrollingFrame")
    tab.Name = name
    tab.Parent = self.Tabs
    tab.Size = UDim2.new(1, 0, 1, 0)
    tab.BackgroundTransparency = 1
    tab.ScrollBarThickness = 0
    tab.ScrollBarImageTransparency = 1
    tab.CanvasSize = UDim2.new(0, 0, 0, 0)
    tab.Visible = false

    local contentFrame = Instance.new("ScrollingFrame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Parent = tab
    contentFrame.Size = UDim2.new(1, 0, 1, 0)
    contentFrame.Position = UDim2.new(0, 0, 0, 0)
    contentFrame.BackgroundTransparency = 1
    contentFrame.ScrollBarThickness = 4
    contentFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 50, 150)
    contentFrame.ScrollBarImageTransparency = 0.3
    contentFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    contentFrame.ZIndex = 2

    local tabButton = Instance.new("TextButton")
    tabButton.Name = name .. "Button"
    tabButton.Parent = self.TabScrollFrame
    tabButton.Text = ""
    tabButton.Size = UDim2.new(1, -6, 0, 34)
    tabButton.Position = UDim2.new(0, 3, 0, (#self.TabButtons * 40))
    tabButton.BackgroundColor3 = Color3.fromRGB(45, 30, 60)
    tabButton.BorderSizePixel = 0
    tabButton.ZIndex = 3

    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 12)
    buttonCorner.Parent = tabButton

    local buttonStroke = Instance.new("UIStroke")
    buttonStroke.Parent = tabButton
    buttonStroke.Color = Color3.fromRGB(90, 50, 130)
    buttonStroke.Thickness = 1
    buttonStroke.Transparency = 0.4

    local imageSize = 20
    if decalID then
        local image = Instance.new("ImageLabel")
        image.Parent = tabButton
        image.Size = UDim2.new(0, imageSize, 0, imageSize)
        image.Position = UDim2.new(0, 5, 0.5, -imageSize/2)
        image.BackgroundTransparency = 1
        image.Image = "rbxassetid://" .. tostring(decalID)
        image.ScaleType = Enum.ScaleType.Fit
        image.ZIndex = 4
    end

    local label = Instance.new("TextLabel")
    label.Parent = tabButton
    label.Text = name
    label.Size = UDim2.new(1, -45, 1, 0)
    label.Position = UDim2.new(0, 45, 0, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 20
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextYAlignment = Enum.TextYAlignment.Center
    label.ZIndex = 4

    table.insert(self.TabButtons, { Button = tabButton, Tab = tab })
    self.TabScrollFrame.CanvasSize = UDim2.new(0, 0, 0, #self.TabButtons * 40)

    tabButton.MouseButton1Click:Connect(function()
        for _, tabInfo in pairs(self.TabButtons) do
            tabInfo.Tab.Visible = false
            tabInfo.Button.BackgroundColor3 = Color3.fromRGB(45, 30, 60)
        end
        tab.Visible = true
        tabButton.BackgroundColor3 = Color3.fromRGB(80, 45, 115)
    end)

    if #self.TabButtons == 1 then
        tab.Visible = true
        tabButton.BackgroundColor3 = Color3.fromRGB(80, 45, 115)
    end

    return { tab = tab, contentFrame = contentFrame }
end

function UILib:AddButton(tab, text, callback)
    local TweenService = game:GetService("TweenService")

    local buttonFrame = Instance.new("Frame")
    buttonFrame.Parent = tab.contentFrame
    buttonFrame.Size = UDim2.new(0.9, 0, 0, 39)
    buttonFrame.Position = UDim2.new(0.05, 0, 0, (#tab.contentFrame:GetChildren() - 1.2) * 43 + 20)
    buttonFrame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
    buttonFrame.BackgroundTransparency = 0
    buttonFrame.BorderSizePixel = 0

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = buttonFrame

    local stroke = Instance.new("UIStroke")
    stroke.Parent = buttonFrame
    stroke.Color = Color3.fromRGB(75, 45, 105)
    stroke.Thickness = 1
    stroke.Transparency = 0.4

    local scale = Instance.new("UIScale")
    scale.Parent = buttonFrame

    local button = Instance.new("TextButton")
    button.Parent = buttonFrame
    button.Size = UDim2.fromScale(1, 1)
    button.BackgroundTransparency = 1
    button.Text = ""
    button.AutoButtonColor = false
    button.ZIndex = 2

    local label = Instance.new("TextLabel")
    label.Parent = buttonFrame
    label.Size = UDim2.new(0.85, 0, 1, 0)
    label.Position = UDim2.new(0.05, 0, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextXAlignment = Enum.TextXAlignment.Left

    local image = Instance.new("ImageLabel")
    image.Parent = buttonFrame
    image.Size = UDim2.new(0, 28, 0, 28)
    image.Position = UDim2.new(0.93, 0, 0.5, -14)
    image.BackgroundTransparency = 1
    image.Image = "rbxassetid://10709791437"
    image.ScaleType = Enum.ScaleType.Fit
    image.ImageColor3 = Color3.fromRGB(180, 130, 255)

    local glow = Instance.new("UIStroke")
    glow.Parent = buttonFrame
    glow.Color = Color3.fromRGB(140, 80, 200)
    glow.Thickness = 1
    glow.Transparency = 0.7

    local tweenInfo = TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local defaultColor = Color3.fromRGB(28, 20, 38)
    local hoverColor = Color3.fromRGB(40, 28, 55)
    local clickColor = Color3.fromRGB(55, 35, 75)

    buttonFrame.MouseEnter:Connect(function()
        TweenService:Create(buttonFrame, tweenInfo, {BackgroundColor3 = hoverColor}):Play()
        TweenService:Create(stroke, tweenInfo, {Color = Color3.fromRGB(120, 70, 170)}):Play()
    end)

    buttonFrame.MouseLeave:Connect(function()
        TweenService:Create(buttonFrame, tweenInfo, {BackgroundColor3 = defaultColor}):Play()
        TweenService:Create(stroke, tweenInfo, {Color = Color3.fromRGB(75, 45, 105)}):Play()
    end)

    button.MouseButton1Click:Connect(function()
        TweenService:Create(buttonFrame, TweenInfo.new(0.07), {BackgroundColor3 = clickColor}):Play()
        TweenService:Create(scale, TweenInfo.new(0.07), {Scale = 1.03}):Play()
        task.wait(0.1)
        TweenService:Create(scale, TweenInfo.new(0.07), {Scale = 1}):Play()
        TweenService:Create(buttonFrame, TweenInfo.new(0.07), {BackgroundColor3 = hoverColor}):Play()
        if callback then
            task.spawn(callback)
        end
    end)

    tab.contentFrame.CanvasSize = UDim2.new(0, 0, 0, (#tab.contentFrame:GetChildren()) * 50)
    return button
end

function UILib:AddToggle(tab, text, defaultState, callback)
    local TweenService = game:GetService("TweenService")

    local toggleFrame = Instance.new("Frame")
    toggleFrame.Parent = tab.contentFrame
    toggleFrame.Size = UDim2.new(0.9, 0, 0, 39)
    toggleFrame.Position = UDim2.new(0.05, 0, 0, (#tab.contentFrame:GetChildren() - 1.2) * 43 + 20)
    toggleFrame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
    toggleFrame.BackgroundTransparency = 0
    toggleFrame.BorderSizePixel = 0

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = toggleFrame

    local stroke = Instance.new("UIStroke")
    stroke.Parent = toggleFrame
    stroke.Color = Color3.fromRGB(75, 45, 105)
    stroke.Thickness = 1
    stroke.Transparency = 0.4

    local glow = Instance.new("UIStroke")
    glow.Parent = toggleFrame
    glow.Color = Color3.fromRGB(140, 80, 200)
    glow.Thickness = 1
    glow.Transparency = 0.7

    local label = Instance.new("TextLabel")
    label.Parent = toggleFrame
    label.Size = UDim2.new(0.8, 0, 1, 0)
    label.Position = UDim2.new(0.05, 0, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextXAlignment = Enum.TextXAlignment.Left

    local switchTrack = Instance.new("Frame")
    switchTrack.Parent = toggleFrame
    switchTrack.Size = UDim2.new(0, 55, 0, 25)
    switchTrack.Position = UDim2.new(0.85, 0, 0.5, -12)
    switchTrack.BackgroundColor3 = Color3.fromRGB(50, 35, 70)
    switchTrack.BorderSizePixel = 0
    Instance.new("UICorner", switchTrack).CornerRadius = UDim.new(1, 0)

    local switchButton = Instance.new("Frame")
    switchButton.Parent = switchTrack
    switchButton.Size = UDim2.new(0, 20, 0, 20)
    switchButton.Position = defaultState and UDim2.new(1, -22, 0.5, -10) or UDim2.new(0, 2, 0.5, -10)
    switchButton.BackgroundColor3 = defaultState and Color3.fromRGB(180, 130, 255) or Color3.fromRGB(255, 255, 255)
    switchButton.BorderSizePixel = 0
    Instance.new("UICorner", switchButton).CornerRadius = UDim.new(1, 0)

    local glowEffect = Instance.new("UIStroke")
    glowEffect.Parent = switchButton
    glowEffect.Color = switchButton.BackgroundColor3
    glowEffect.Thickness = 2
    glowEffect.Transparency = 0.3

    local hoverTweenInfo = TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local clickTweenInfo = TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local defaultColor = Color3.fromRGB(28, 20, 38)
    local hoverColor = Color3.fromRGB(40, 28, 55)
    local defaultSize = toggleFrame.Size
    local toggling = false

    toggleFrame.MouseEnter:Connect(function()
        TweenService:Create(toggleFrame, hoverTweenInfo, { BackgroundColor3 = hoverColor }):Play()
    end)

    toggleFrame.MouseLeave:Connect(function()
        TweenService:Create(toggleFrame, hoverTweenInfo, { BackgroundColor3 = defaultColor, Size = defaultSize }):Play()
    end)

    local function toggle()
        if toggling then return end
        toggling = true

        defaultState = not defaultState
        local targetColor = defaultState and Color3.fromRGB(180, 130, 255) or Color3.fromRGB(255, 255, 255)
        local targetPos = defaultState and UDim2.new(1, -22, 0.5, -10) or UDim2.new(0, 2, 0.5, -10)

        TweenService:Create(switchButton, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            Position = targetPos,
            BackgroundColor3 = targetColor
        }):Play()

        TweenService:Create(glowEffect, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            Color = targetColor
        }):Play()

        local pressTween = TweenService:Create(toggleFrame, clickTweenInfo, { Size = UDim2.new(defaultSize.X.Scale, 0, 0, 38) })
        pressTween:Play()
        pressTween.Completed:Wait()

        if callback then
            task.spawn(function()
                callback(defaultState)
            end)
        end

        task.wait(0.1)
        toggling = false
    end

    local function handleClick(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            toggle()
        end
    end

    toggleFrame.InputBegan:Connect(handleClick)
    switchTrack.InputBegan:Connect(handleClick)

    tab.contentFrame.CanvasSize = UDim2.new(0, 0, 0, (#tab.contentFrame:GetChildren()) * 50)
    
    local function SetState(newState)
        if newState == defaultState then return end
        defaultState = newState
        local targetColor = defaultState and Color3.fromRGB(180, 130, 255) or Color3.fromRGB(255, 255, 255)
        local targetPos = defaultState and UDim2.new(1, -22, 0.5, -10) or UDim2.new(0, 2, 0.5, -10)
        TweenService:Create(switchButton, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            Position = targetPos,
            BackgroundColor3 = targetColor
        }):Play()
        TweenService:Create(glowEffect, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            Color = targetColor
        }):Play()
    end
    
    return { Track = switchTrack, SetState = SetState }
end

function UILib:AddTextbox(tab, text, placeholderText, callback)
    local TweenService = game:GetService("TweenService")

    local textboxFrame = Instance.new("Frame")
    textboxFrame.Parent = tab.contentFrame
    textboxFrame.Size = UDim2.new(0.9, 0, 0, 40)
    textboxFrame.Position = UDim2.new(0.05, 0, 0, (#tab.contentFrame:GetChildren() - 1.2) * 43 + 20)
    textboxFrame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
    textboxFrame.BorderSizePixel = 0

    local frameCorner = Instance.new("UICorner")
    frameCorner.CornerRadius = UDim.new(0, 12)
    frameCorner.Parent = textboxFrame

    local stroke = Instance.new("UIStroke")
    stroke.Parent = textboxFrame
    stroke.Color = Color3.fromRGB(75, 45, 105)
    stroke.Thickness = 1
    stroke.Transparency = 0.4

    local glow = Instance.new("UIStroke")
    glow.Parent = textboxFrame
    glow.Color = Color3.fromRGB(140, 80, 200)
    glow.Thickness = 1
    glow.Transparency = 0.7

    local label = Instance.new("TextLabel")
    label.Parent = textboxFrame
    label.Size = UDim2.new(0.4, 0, 1, 0)
    label.Position = UDim2.new(0.05, 0, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextXAlignment = Enum.TextXAlignment.Left

    local textbox = Instance.new("TextBox")
    textbox.Parent = textboxFrame
    textbox.Text = ""
    textbox.PlaceholderText = placeholderText or "Type here"
    textbox.PlaceholderColor3 = Color3.fromRGB(150, 120, 180)
    textbox.Size = UDim2.new(0.52, 0, 0.8, 0)
    textbox.Position = UDim2.new(0.45, 0, 0.1, 0)
    textbox.BackgroundColor3 = Color3.fromRGB(38, 28, 52)
    textbox.TextColor3 = Color3.fromRGB(255, 255, 255)
    textbox.Font = Enum.Font.Gotham
    textbox.TextSize = 15
    textbox.BorderSizePixel = 0
    textbox.ClearTextOnFocus = false

    local textboxCorner = Instance.new("UICorner")
    textboxCorner.CornerRadius = UDim.new(0, 10)
    textboxCorner.Parent = textbox

    local textboxStroke = Instance.new("UIStroke")
    textboxStroke.Parent = textbox
    textboxStroke.Color = Color3.fromRGB(90, 55, 130)
    textboxStroke.Thickness = 1
    textboxStroke.Transparency = 0.5

    textbox.Focused:Connect(function()
        TweenService:Create(textboxStroke, TweenInfo.new(0.2), { Color = Color3.fromRGB(140, 80, 200), Transparency = 0.2 }):Play()
        TweenService:Create(textbox, TweenInfo.new(0.2), { BackgroundColor3 = Color3.fromRGB(48, 35, 65) }):Play()
    end)

    textbox.FocusLost:Connect(function(enterPressed)
        TweenService:Create(textboxStroke, TweenInfo.new(0.2), { Color = Color3.fromRGB(90, 55, 130), Transparency = 0.5 }):Play()
        TweenService:Create(textbox, TweenInfo.new(0.2), { BackgroundColor3 = Color3.fromRGB(38, 28, 52) }):Play()
        if enterPressed then
            callback(textbox.Text)
        end
    end)

    tab.contentFrame.CanvasSize = UDim2.new(0, 0, 0, (#tab.contentFrame:GetChildren()) * 50)

    return textbox
end

function UILib:AddSlider(tab, text, min, max, defaultValue, callback)
    local TweenService = game:GetService("TweenService")
    
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Parent = tab.contentFrame
    sliderFrame.Size = UDim2.new(0.9, 0, 0, 40)
    sliderFrame.Position = UDim2.new(0.05, 0, 0, (#tab.contentFrame:GetChildren() - 1.2) * 43 + 20)
    sliderFrame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
    sliderFrame.BorderSizePixel = 0

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = sliderFrame

    local stroke = Instance.new("UIStroke")
    stroke.Parent = sliderFrame
    stroke.Color = Color3.fromRGB(75, 45, 105)
    stroke.Thickness = 1
    stroke.Transparency = 0.4

    local label = Instance.new("TextLabel")
    label.Parent = sliderFrame
    label.Text = text
    label.Size = UDim2.new(0.7, 0, 0.4, 0)
    label.Position = UDim2.new(0.09, 0, 0.1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Center

    local valueLabel = Instance.new("TextLabel")
    valueLabel.Parent = sliderFrame
    valueLabel.Text = tostring(defaultValue)
    valueLabel.Size = UDim2.new(0.2, 0, 0.4, 0)
    valueLabel.Position = UDim2.new(0.75, 0, 0.1, 0)
    valueLabel.BackgroundTransparency = 1
    valueLabel.TextColor3 = Color3.fromRGB(180, 130, 255)
    valueLabel.Font = Enum.Font.GothamBold
    valueLabel.TextSize = 14
    valueLabel.TextXAlignment = Enum.TextXAlignment.Right

    local sliderBar = Instance.new("Frame")
    sliderBar.Parent = sliderFrame
    sliderBar.Size = UDim2.new(0.95, 0, 0.25, 0)
    sliderBar.Position = UDim2.new(0.025, 0, 0.55, 0)
    sliderBar.BackgroundColor3 = Color3.fromRGB(50, 35, 70)
    sliderBar.BorderSizePixel = 0

    local barCorner = Instance.new("UICorner")
    barCorner.CornerRadius = UDim.new(1, 0)
    barCorner.Parent = sliderBar

    local fillBar = Instance.new("Frame")
    fillBar.Parent = sliderBar
    fillBar.Size = UDim2.new((defaultValue - min) / (max - min), 0, 1, 0)
    fillBar.BackgroundColor3 = Color3.fromRGB(150, 80, 220)
    fillBar.BorderSizePixel = 0

    local fillCorner = Instance.new("UICorner")
    fillCorner.CornerRadius = UDim.new(1, 0)
    fillCorner.Parent = fillBar

    local fillGradient = Instance.new("UIGradient")
    fillGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(120, 60, 180)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(180, 100, 255))
    })
    fillGradient.Parent = fillBar

    local dragging = false

    local function updateSlider(input)
        local relativeX = math.clamp((input.Position.X - sliderBar.AbsolutePosition.X) / sliderBar.AbsoluteSize.X, 0, 1)
        local newValue = math.floor(min + (max - min) * relativeX)
        fillBar.Size = UDim2.new(relativeX, 0, 1, 0)
        valueLabel.Text = tostring(newValue)
        callback(newValue)
    end

    sliderBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            updateSlider(input)
        end
    end)

    sliderBar.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)

    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            updateSlider(input)
        end
    end)

    tab.contentFrame.CanvasSize = UDim2.new(0, 0, 0, (#tab.contentFrame:GetChildren()) * 50)
    return sliderFrame
end

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

function UILib:AddBuyersTab(name, decalID)
    local TweenService = game:GetService("TweenService")
    local tab = self:AddTab(name, decalID)

    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Parent = tab.contentFrame
    scrollFrame.Size = UDim2.new(1, 0, 1, -50)
    scrollFrame.Position = UDim2.new(0, 0, 0, 50)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollFrame.ScrollBarThickness = 4
    scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 50, 150)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y

    local listLayout = Instance.new("UIListLayout", scrollFrame)
    listLayout.Padding = UDim.new(0, 12)
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.VerticalAlignment = Enum.VerticalAlignment.Top
    listLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    local addUserBox = Instance.new("TextBox")
    addUserBox.Parent = tab.contentFrame
    addUserBox.PlaceholderText = "Type here"
    addUserBox.PlaceholderColor3 = Color3.fromRGB(150, 120, 180)
    addUserBox.Text = ""
    addUserBox.Size = UDim2.new(0.7, 0, 0, 36)
    addUserBox.Position = UDim2.new(0.05, 0, 0, 10)
    addUserBox.BackgroundColor3 = Color3.fromRGB(38, 28, 52)
    addUserBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    addUserBox.Font = Enum.Font.Gotham
    addUserBox.TextSize = 16
    addUserBox.BorderSizePixel = 0
    Instance.new("UICorner", addUserBox).CornerRadius = UDim.new(0, 8)

    local addUserBoxStroke = Instance.new("UIStroke", addUserBox)
    addUserBoxStroke.Color = Color3.fromRGB(90, 55, 130)
    addUserBoxStroke.Thickness = 1
    addUserBoxStroke.Transparency = 0.5

    addUserBox.Focused:Connect(function()
        TweenService:Create(addUserBoxStroke, TweenInfo.new(0.2), { Color = Color3.fromRGB(140, 80, 200), Transparency = 0.2 }):Play()
    end)
    addUserBox.FocusLost:Connect(function()
        TweenService:Create(addUserBoxStroke, TweenInfo.new(0.2), { Color = Color3.fromRGB(90, 55, 130), Transparency = 0.5 }):Play()
    end)

    local addButton = Instance.new("TextButton")
    addButton.Parent = tab.contentFrame
    addButton.Size = UDim2.new(0.2, 0, 0, 36)
    addButton.Position = UDim2.new(0.77, 0, 0, 10)
    addButton.BackgroundColor3 = Color3.fromRGB(60, 35, 85)
    addButton.Text = "Add Buyer"
    addButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    addButton.Font = Enum.Font.GothamBold
    addButton.TextSize = 14
    addButton.BorderSizePixel = 0
    addButton.AutoButtonColor = false
    Instance.new("UICorner", addButton).CornerRadius = UDim.new(0, 8)

    local addButtonStroke = Instance.new("UIStroke", addButton)
    addButtonStroke.Color = Color3.fromRGB(100, 60, 150)
    addButtonStroke.Thickness = 1
    addButtonStroke.Transparency = 0.4

    addButton.MouseEnter:Connect(function()
        TweenService:Create(addButton, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(80, 50, 110)}):Play()
    end)
    addButton.MouseLeave:Connect(function()
        TweenService:Create(addButton, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(60, 35, 85)}):Play()
    end)

    local function findPlayer(text)
        text = text:lower()
        for _, p in ipairs(Players:GetPlayers()) do
            if p.Name:lower():find(text) or p.DisplayName:lower():find(text) then
                return p
            end
        end
    end

    local function FormatNumber(n)
        local formatted = tostring(n):reverse():gsub("(%d%d%d)", "%1."):reverse()
        if formatted:sub(1,1) == "." then
            formatted = formatted:sub(2)
        end
        return formatted
    end

    local function ParseGoal(str)
        if not str or str == "" then return 0 end
        str = tostring(str):lower():gsub("%s+", "")
        str = str:gsub(",", ".")
        local number, suffix = str:match("([%d%.]+)([kmb]?)")
        if number then
            local n = tonumber(number)
            if not n then return 0 end
            if suffix == "k" then n = n * 1e3
            elseif suffix == "m" then n = n * 1e6
            elseif suffix == "b" then n = n * 1e9
            end
            return math.floor(n)
        end
        local cleaned = str:match("([%d]+)")
        return tonumber(cleaned) or 0
    end

    local function NewTarget(targetPlayer)
        local frame = Instance.new("Frame")
        frame.Parent = scrollFrame
        frame.Size = UDim2.new(0.95, 0, 0, 115)
        frame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
        frame.BorderSizePixel = 0
        Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

        local frameStroke = Instance.new("UIStroke", frame)
        frameStroke.Color = Color3.fromRGB(75, 45, 105)
        frameStroke.Thickness = 1
        frameStroke.Transparency = 0.4

        local thumb = Instance.new("ImageLabel")
        thumb.Parent = frame
        thumb.Size = UDim2.new(0, 70, 0, 70)
        thumb.Position = UDim2.new(0, 10, 0, 10)
        thumb.BackgroundTransparency = 1
        Instance.new("UICorner", thumb).CornerRadius = UDim.new(1, 0)
        task.spawn(function()
            local content = Players:GetUserThumbnailAsync(
                targetPlayer.UserId,
                Enum.ThumbnailType.HeadShot,
                Enum.ThumbnailSize.Size100x100
            )
            thumb.Image = content
        end)

        local mobileIcon = Instance.new("ImageLabel")
        mobileIcon.Parent = thumb
        mobileIcon.Size = UDim2.new(0, 10, 0, 10)
        mobileIcon.Position = UDim2.new(1, -12, 1, -12)
        mobileIcon.BackgroundTransparency = 1
        mobileIcon.Image = "rbxassetid://97640841498727"
        mobileIcon.Visible = false

        pcall(function()
            if targetPlayer == Players.LocalPlayer then
                if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then
                    mobileIcon.Visible = true
                end
            else
                local joinData = targetPlayer:GetJoinData()
                if joinData and joinData.OsPlatform and (tostring(joinData.OsPlatform):find("IOS") or tostring(joinData.OsPlatform):find("Android")) then
                    mobileIcon.Visible = true
                end
            end
        end)

        local checkmark = Instance.new("ImageLabel")
        checkmark.Parent = thumb
        checkmark.Image = "rbxassetid://136568734138545"
        checkmark.Size = UDim2.new(0, 55, 0, 55)
        checkmark.Position = UDim2.new(0, 10, 0, 10)
        checkmark.BackgroundTransparency = 1
        checkmark.Visible = false

        local nameLabel = Instance.new("TextLabel")
        nameLabel.Parent = frame
        nameLabel.Text = targetPlayer.DisplayName .. " (@" .. targetPlayer.Name .. ")"
        nameLabel.Position = UDim2.new(0, 90, 0, 10)
        nameLabel.Size = UDim2.new(0.6, 0, 0, 25)
        nameLabel.Font = Enum.Font.GothamBold
        nameLabel.TextSize = 17
        nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        nameLabel.BackgroundTransparency = 1
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left

        local currencyValue = targetPlayer:WaitForChild("DataFolder"):WaitForChild("Currency")
        local startCurrency = currencyValue.Value
        local earnedSoFar = 0

        local currentLabel = Instance.new("TextLabel")
        currentLabel.Parent = frame
        currentLabel.Text = "Loading..."
        currentLabel.Position = UDim2.new(0, 90, 0, 35)
        currentLabel.Size = UDim2.new(0.5, 0, 0, 20)
        currentLabel.Font = Enum.Font.GothamBold
        currentLabel.TextSize = 14
        currentLabel.TextColor3 = Color3.fromRGB(120, 255, 180)
        currentLabel.BackgroundTransparency = 1
        currentLabel.TextXAlignment = Enum.TextXAlignment.Left

        local remainingLabel = Instance.new("TextLabel")
        remainingLabel.Parent = frame
        remainingLabel.Text = "Remaining: -"
        remainingLabel.Position = UDim2.new(0, 90, 0, 55)
        remainingLabel.Size = UDim2.new(0.5, 0, 0, 18)
        remainingLabel.Font = Enum.Font.Gotham
        remainingLabel.TextSize = 12
        remainingLabel.TextColor3 = Color3.fromRGB(180, 130, 255)
        remainingLabel.BackgroundTransparency = 1
        remainingLabel.TextXAlignment = Enum.TextXAlignment.Left

        local goalBox = Instance.new("TextBox")
        goalBox.Parent = frame
        goalBox.Text = ""
        goalBox.PlaceholderText = "Set goal..."
        goalBox.PlaceholderColor3 = Color3.fromRGB(150, 120, 180)
        goalBox.Size = UDim2.new(0, 240, 0, 28)
        goalBox.Position = UDim2.new(0, 90, 0, 75)
        goalBox.BackgroundColor3 = Color3.fromRGB(38, 28, 52)
        goalBox.TextColor3 = Color3.fromRGB(255, 255, 255)
        goalBox.Font = Enum.Font.Gotham
        goalBox.TextSize = 14
        goalBox.BorderSizePixel = 0
        goalBox.ClearTextOnFocus = false
        goalBox.TextEditable = true
        Instance.new("UICorner", goalBox).CornerRadius = UDim.new(0, 6)

        local goalBoxStroke = Instance.new("UIStroke", goalBox)
        goalBoxStroke.Color = Color3.fromRGB(90, 55, 130)
        goalBoxStroke.Thickness = 1
        goalBoxStroke.Transparency = 0.5

        local removeBtn = Instance.new("ImageButton")
        removeBtn.Parent = frame
        removeBtn.Size = UDim2.new(0, 23, 0, 23)
        removeBtn.Position = UDim2.new(1, -30, 0, 5)
        removeBtn.BackgroundTransparency = 1
        removeBtn.Image = "rbxassetid://112950838956740"
        removeBtn.MouseButton1Click:Connect(function()
            frame:Destroy()
        end)

        local goalValue = 0
        local goalSent = false
        local goalSetSent = false
        local currentGoalActive = false

        local earnedSoFar = 0
        local goalStartCurrency = currencyValue.Value

        -- Billboard encima de la cabeza del buyer
        local TextService = game:GetService("TextService")
        
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "BuyerBillboard"
        billboard.Adornee = nil
        billboard.AlwaysOnTop = true
        billboard.Size = UDim2.new(0, 220, 0, 50)
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.LightInfluence = 0
        billboard.MaxDistance = 150
        billboard.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

        local billboardFrame = Instance.new("Frame", billboard)
        billboardFrame.Size = UDim2.new(1, 0, 1, 0)
        billboardFrame.BackgroundColor3 = Color3.fromRGB(25, 18, 35)
        billboardFrame.BackgroundTransparency = 0.15
        billboardFrame.BorderSizePixel = 0
        Instance.new("UICorner", billboardFrame).CornerRadius = UDim.new(0, 10)

        local billboardStroke = Instance.new("UIStroke", billboardFrame)
        billboardStroke.Color = Color3.fromRGB(100, 60, 150)
        billboardStroke.Thickness = 1.5
        billboardStroke.Transparency = 0.3

        local billboardThumb = Instance.new("ImageLabel", billboardFrame)
        billboardThumb.Size = UDim2.new(0, 36, 0, 36)
        billboardThumb.Position = UDim2.new(0, 8, 0.5, -18)
        billboardThumb.BackgroundColor3 = Color3.fromRGB(40, 28, 55)
        billboardThumb.BorderSizePixel = 0
        Instance.new("UICorner", billboardThumb).CornerRadius = UDim.new(1, 0)

        task.spawn(function()
            local content = Players:GetUserThumbnailAsync(
                targetPlayer.UserId,
                Enum.ThumbnailType.HeadShot,
                Enum.ThumbnailSize.Size100x100
            )
            billboardThumb.Image = content
        end)

        local billboardLabel = Instance.new("TextLabel", billboardFrame)
        billboardLabel.Size = UDim2.new(1, -56, 1, 0)
        billboardLabel.Position = UDim2.new(0, 50, 0, 0)
        billboardLabel.BackgroundTransparency = 1
        billboardLabel.Font = Enum.Font.GothamBold
        billboardLabel.TextSize = 16
        billboardLabel.TextXAlignment = Enum.TextXAlignment.Left
        billboardLabel.RichText = true
        billboardLabel.Text = '<font color="#FFFFFF">$0</font> / <font color="#B482FF">$0</font>'
        
        -- Función para actualizar el billboard
        local function updateBillboard()
            local current = currencyValue.Value
            local displayText = ""
            
            if goalValue > 0 then
                local goalTotal = goalStartCurrency + goalValue
                local reachedGoal = earnedSoFar >= goalValue
                
                if reachedGoal then
                    displayText = '<font color="#B482FF">$' .. FormatNumber(current) .. '</font> / <font color="#B482FF">$' .. FormatNumber(goalTotal) .. '</font>'
                else
                    displayText = '<font color="#FFFFFF">$' .. FormatNumber(current) .. '</font> / <font color="#B482FF">$' .. FormatNumber(goalTotal) .. '</font>'
                end
            else
                displayText = '<font color="#FFFFFF">$' .. FormatNumber(current) .. '</font> / <font color="#808080">-</font>'
            end
            
            billboardLabel.Text = displayText
            
            -- Calcular tamaño del texto (sin tags HTML)
            local plainText = "$" .. FormatNumber(current) .. " / "
            if goalValue > 0 then
                plainText = plainText .. "$" .. FormatNumber(goalStartCurrency + goalValue)
            else
                plainText = plainText .. "-"
            end
            
            local textSize = TextService:GetTextSize(plainText, 16, Enum.Font.GothamBold, Vector2.new(1000, 50))
            local newWidth = math.max(textSize.X + 70, 150) -- 70 = espacio para imagen + padding
            
            billboard.Size = UDim2.new(0, newWidth, 0, 50)
        end

        -- Conectar al personaje del buyer
        local function attachBillboard()
            if targetPlayer.Character then
                local head = targetPlayer.Character:FindFirstChild("Head")
                if head then
                    billboard.Adornee = head
                end
            end
        end

        attachBillboard()
        targetPlayer.CharacterAdded:Connect(function(char)
            task.wait(0.5)
            attachBillboard()
        end)
        updateBillboard()

        -- Destruir billboard cuando se elimine el frame
        frame.Destroying:Connect(function()
            billboard:Destroy()
        end)

        local function updateLabels()
            local current = currencyValue.Value
            local diff = current - startCurrency

            if diff > 0 then
                earnedSoFar = earnedSoFar + diff
            end

            startCurrency = current

            local remaining = math.max(goalValue - earnedSoFar, 0)

            currentLabel.Text = "Current DHC: $" .. FormatNumber(current)

            if goalValue > 0 then
                remainingLabel.Text = "Remaining: $" .. FormatNumber(remaining)
            else
                remainingLabel.Text = "Remaining: -"
            end

            if remaining > 0 then
                checkmark.Visible = false
            end
            updateBillboard()
        end

        currencyValue:GetPropertyChangedSignal("Value"):Connect(updateLabels)

        goalBox.FocusLost:Connect(function(enterPressed)
            local parsed = ParseGoal(goalBox.Text)

            if parsed > 0 then

                goalValue = parsed
                goalBox.Text = FormatNumber(goalValue)

                earnedSoFar = 0
                goalSent = false
                currentGoalActive = true
                goalSetSent = false

                goalStartCurrency = currencyValue.Value
                startCurrency = currencyValue.Value

                if not goalSetSent then
                    goalSetSent = true

                    local goalSetMsg = getgenv().Settings.Shouts["Goal Set"] or "{buyer} Your goal has been set, start picking up your DHC"
                    goalSetMsg = goalSetMsg:gsub("{buyer}", "@" .. targetPlayer.Name)

                    game.ReplicatedStorage:WaitForChild("MainEvent"):FireServer("Shout", goalSetMsg)

                    if getgenv().AddGoalSetLog then
                        getgenv().AddGoalSetLog(targetPlayer)
                    end

                    if getgenv().BringOnGoalSet then
                        game.ReplicatedStorage:WaitForChild("MainEvent"):FireServer("VIP_CMD", "Summon", targetPlayer)
                    end
                end

            else
                goalValue = 0
                goalSent = false
                goalSetSent = false
                currentGoalActive = false
                earnedSoFar = 0
            end

            updateLabels()
        end)

        task.spawn(function()
            while frame.Parent do
                if goalValue > 0 then
                    local remaining = math.max(goalValue - earnedSoFar, 0)

                    if not goalSent and remaining == 0 then
                        goalSent = true
                        checkmark.Visible = true

                        local proofWebhook = getgenv().Settings.Webhooks.Proofs

                        if proofWebhook and proofWebhook ~= "" then
                            local username = targetPlayer.Name
                            local userId = targetPlayer.UserId

                            local data = {
                                ["embeds"] = {{
                                    ["title"] = "Order Completed!",
                                    ["color"] = 16777215,
                                    ["fields"] = {
                                        {
                                            ["name"] = "Username:",
                                            ["value"] = "```@" .. username .. "```",
                                            ["inline"] = true
                                        },
                                        {
                                            ["name"] = "User ID:",
                                            ["value"] = "```" .. tostring(userId) .. "```",
                                            ["inline"] = true
                                        },
                                        {
                                            ["name"] = "Profile:",
                                            ["value"] = "[Click here](https://www.roblox.com/users/" .. userId .. "/profile)",
                                            ["inline"] = true
                                        },
                                        {
                                            ["name"] = "",
                                            ["value"] = "",
                                            ["inline"] = false
                                        },
                                        {
                                            ["name"] = "Goal:",
                                            ["value"] = "```$" .. FormatNumber(goalValue) .. "```",
                                            ["inline"] = true
                                        },
                                        {
                                            ["name"] = "Earned:",
                                            ["value"] = "```$" .. FormatNumber(earnedSoFar) .. "```",
                                            ["inline"] = true
                                        },
                                        {
                                            ["name"] = "Final Cash:",
                                            ["value"] = "```$" .. FormatNumber(currencyValue.Value) .. "```",
                                            ["inline"] = true
                                        }
                                    },
                                    ["image"] = {
                                        ["url"] = ""
                                    }
                                }}
                            }

                            local json = HttpService:JSONEncode(data)
                            local requestFunc = request or http_request or (syn and syn.request)

                            if requestFunc then
                                pcall(function()
                                    requestFunc({
                                        Url = proofWebhook,
                                        Method = "POST",
                                        Headers = {["Content-Type"] = "application/json"},
                                        Body = json
                                    })
                                end)
                            end
                        end

                        if getgenv().AddGoalLog then
                            getgenv().AddGoalLog(targetPlayer, goalValue, earnedSoFar)
                        end

                        local goalReachedMsg =
                            getgenv().Settings.Shouts["Goal Reached"]
                            or "Thank you {buyer}, please leave and make sure to vouch!"

                        goalReachedMsg = goalReachedMsg:gsub("{buyer}", "@" .. targetPlayer.Name)

                        game.ReplicatedStorage:WaitForChild("MainEvent"):FireServer("Shout", goalReachedMsg)

                        if getgenv().BringOnGoalFinished then
                            game.ReplicatedStorage:WaitForChild("MainEvent"):FireServer("VIP_CMD", "Summon", targetPlayer)
                        end

                        if getgenv().bringlocationgoalreached then
                            local vaultPosition = Vector3.new(-679.0545, -31.0067, -285.0799)
                            local lp = game.Players.LocalPlayer

                            if not lp.Character then
                                lp.CharacterAdded:Wait()
                            end

                            local hrp = lp.Character:FindFirstChild("HumanoidRootPart")
                            if not hrp then
                                lp.Character:WaitForChild("HumanoidRootPart")
                                hrp = lp.Character.HumanoidRootPart
                            end

                            local originalPos = hrp.CFrame

                            hrp.CFrame = CFrame.new(vaultPosition)

                            task.wait(0.1)

                            game.ReplicatedStorage:WaitForChild("MainEvent"):FireServer("VIP_CMD", "Summon", getgenv().targetPlayer)

                            task.wait(0.3)

                            hrp.CFrame = originalPos
                        end

                        if getgenv().KickOnGoalReached then
                            task.delay(3, function()
                                game.ReplicatedStorage:WaitForChild("MainEvent"):FireServer("VIP_CMD", "Kick", targetPlayer)
                            end)
                        end
                    end
                end

                updateLabels()
                task.wait(1)
            end
        end)

        local btnContainer = Instance.new("Frame")
        btnContainer.Parent = frame
        btnContainer.Position = UDim2.new(0, 340, 0, 35)
        btnContainer.Size = UDim2.new(0, 62, 0, 62)
        btnContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        btnContainer.BorderSizePixel = 0
        btnContainer.BackgroundTransparency = 1

        local layout = Instance.new("UIGridLayout")
        layout.Parent = btnContainer
        layout.CellSize = UDim2.new(0, 28, 0, 28)
        layout.CellPadding = UDim2.new(0, 6, 0, 6)
        layout.SortOrder = Enum.SortOrder.LayoutOrder
        layout.FillDirection = Enum.FillDirection.Horizontal
        layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
        layout.VerticalAlignment = Enum.VerticalAlignment.Center

        local function makeButton(icon)
            local b = Instance.new("ImageButton")
            b.Size = UDim2.new(0, 28, 0, 28)
            b.BackgroundColor3 = Color3.fromRGB(45, 30, 60)
            b.BorderSizePixel = 0
            b.Image = icon
            b.AutoButtonColor = false
            Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
            local stroke = Instance.new("UIStroke", b)
            stroke.Color = Color3.fromRGB(75, 45, 105)
            stroke.Transparency = 0.4
            stroke.Thickness = 1
            b.MouseEnter:Connect(function()
                TweenService:Create(b, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(65, 45, 90)}):Play()
            end)
            b.MouseLeave:Connect(function()
                TweenService:Create(b, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(45, 30, 60)}):Play()
            end)
            return b
        end

        local tpBtn = makeButton("rbxassetid://128816882886576")
        tpBtn.Parent = btnContainer
        tpBtn.MouseButton1Click:Connect(function()
            if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local localChar = game.Players.LocalPlayer.Character
                if localChar and localChar:FindFirstChild("HumanoidRootPart") then
                    localChar.HumanoidRootPart.CFrame = CFrame.new(targetPlayer.Character.HumanoidRootPart.Position)
                end
            end
        end)

        local bringBtn = makeButton("rbxassetid://82483452806105")
        bringBtn.Parent = btnContainer
        bringBtn.MouseButton1Click:Connect(function()
            game.ReplicatedStorage.MainEvent:FireServer("VIP_CMD", "Summon", targetPlayer)
        end)

        local babyBtn = makeButton("rbxassetid://134307538001336")
        babyBtn.Parent = btnContainer
        babyBtn.MouseButton1Click:Connect(function()
            local mainEvent = game.ReplicatedStorage:WaitForChild("MainEvent")
            mainEvent:FireServer("VIP_CMD", "BabySize", targetPlayer)
        end)

        local kickBtn = makeButton("rbxassetid://92434223807847")
        kickBtn.Parent = btnContainer
        kickBtn.MouseButton1Click:Connect(function()
            local player = game.Players.LocalPlayer
            local targetName = targetPlayer.Name
            local blur = Instance.new("BlurEffect")
            blur.Size = 0
            blur.Parent = game.Lighting
            game:GetService("TweenService"):Create(blur, TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {Size = 20}):Play()

            local confirmGui = Instance.new("ScreenGui")
            confirmGui.Parent = player:WaitForChild("PlayerGui")
            confirmGui.IgnoreGuiInset = true
            confirmGui.ResetOnSpawn = false

            local frame = Instance.new("Frame")
            frame.Parent = confirmGui
            frame.Size = UDim2.new(0, 300, 0, 160)
            frame.Position = UDim2.new(0.5, -150, 0.5, -80)
            frame.BackgroundColor3 = Color3.fromRGB(25, 18, 35)
            frame.BorderSizePixel = 0
            Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)
            local stroke = Instance.new("UIStroke", frame)
            stroke.Color = Color3.fromRGB(80, 50, 120)
            stroke.Thickness = 1
            stroke.Transparency = 0.4

            local shadow = Instance.new("ImageLabel", frame)
            shadow.AnchorPoint = Vector2.new(0.5, 0.5)
            shadow.Position = UDim2.new(0.5, 0, 0.5, 5)
            shadow.Size = UDim2.new(1, 15, 1, 15)
            shadow.BackgroundTransparency = 1
            shadow.Image = "rbxassetid://1316045217"
            shadow.ImageColor3 = Color3.fromRGB(60, 20, 100)
            shadow.ImageTransparency = 0.6
            shadow.ZIndex = 0

            local title = Instance.new("TextLabel")
            title.Parent = frame
            title.BackgroundTransparency = 1
            title.Size = UDim2.new(1, -20, 0, 60)
            title.Position = UDim2.new(0, 10, 0.1, 0)
            title.Font = Enum.Font.GothamBold
            title.TextSize = 20
            title.TextColor3 = Color3.fromRGB(255, 255, 255)
            title.Text = "Are you sure you want to kick @" .. targetName .. "?"
            title.TextWrapped = true

            local yesBtn = Instance.new("TextButton")
            yesBtn.Parent = frame
            yesBtn.Size = UDim2.new(0.4, 0, 0, 40)
            yesBtn.Position = UDim2.new(0.1, 0, 0.65, 0)
            yesBtn.BackgroundColor3 = Color3.fromRGB(255, 45, 45)
            yesBtn.Font = Enum.Font.GothamBold
            yesBtn.TextSize = 20
            yesBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
            yesBtn.Text = "Yes"
            Instance.new("UICorner", yesBtn).CornerRadius = UDim.new(0, 10)

            local noBtn = Instance.new("TextButton")
            noBtn.Parent = frame
            noBtn.Size = UDim2.new(0.4, 0, 0, 40)
            noBtn.Position = UDim2.new(0.52, 0, 0.65, 0)
            noBtn.BackgroundColor3 = Color3.fromRGB(60, 40, 85)
            noBtn.Font = Enum.Font.GothamBold
            noBtn.TextSize = 20
            noBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
            noBtn.Text = "No"
            Instance.new("UICorner", noBtn).CornerRadius = UDim.new(0, 10)

            local function cleanup()
                confirmGui:Destroy()
                game:GetService("TweenService"):Create(blur, TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {Size = 0}):Play()
                task.wait(0.3)
                blur:Destroy()
            end

            yesBtn.MouseButton1Click:Connect(function()
                cleanup()
                game.ReplicatedStorage.MainEvent:FireServer("VIP_CMD", "Kick", targetPlayer)
            end)

            noBtn.MouseButton1Click:Connect(cleanup)
        end)
    end

    addButton.MouseButton1Click:Connect(function()
        local targetPlayer = findPlayer(addUserBox.Text)
        if targetPlayer then
            NewTarget(targetPlayer)
            addUserBox.Text = ""
        else
            addUserBox.PlaceholderText = "Player not found!"
        end
    end)

    local Players = game:GetService("Players")
    local HttpService = game:GetService("HttpService")

    local logsWebhook = getgenv().Settings.Webhooks.Logs
    local joinedPlayers = {}

    local function SendWebhook(data)
        if not logsWebhook or logsWebhook == "" then return end
        local encoded = HttpService:JSONEncode(data)
        local req = request or http_request or (syn and syn.request)
        if req then
            pcall(function()
                req({
                    Url = logsWebhook,
                    Method = "POST",
                    Headers = {["Content-Type"] = "application/json"},
                    Body = encoded
                })
            end)
        end
    end

    Players.PlayerAdded:Connect(function(player)

        if joinedPlayers[player.UserId] then
            SendWebhook({
                ["embeds"] = {{
                    ["color"] = 15073024,
                    ["title"] = "Player Rejoined",
                    ["fields"] = {
                        {
                            ["name"] = "Username:",
                            ["value"] = "```@" .. player.Name .. "```",
                            ["inline"] = true
                        },
                        {
                            ["name"] = "UserID:",
                            ["value"] = "```" .. player.UserId .. "```",
                            ["inline"] = true
                        }
                    }
                }},
                ["components"] = {}
            })

        else
            SendWebhook({
                ["embeds"] = {{
                    ["color"] = 4783872,
                    ["title"] = "Player Joined",
                    ["fields"] = {
                        {
                            ["name"] = "Username:",
                            ["value"] = "```@" .. player.Name .. "```",
                            ["inline"] = true
                        },
                        {
                            ["name"] = "UserID:",
                            ["value"] = "```" .. player.UserId .. "```",
                            ["inline"] = true
                        }
                    }
                }},
                ["components"] = {}
            })
        end

        joinedPlayers[player.UserId] = true
    end)

    Players.PlayerRemoving:Connect(function(player)
        SendWebhook({
            ["embeds"] = {{
                ["color"] = 16711680,
                ["title"] = "Player Left",
                ["fields"] = {
                    {
                        ["name"] = "Username:",
                        ["value"] = "```@" .. player.Name .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "UserID:",
                        ["value"] = "```" .. player.UserId .. "```",
                        ["inline"] = true
                    }
                }
            }},
            ["components"] = {}
        })
    end)

    getgenv().AddGoalSetLog = function(targetPlayer)
        local goalAmount = getgenv().Settings.Goal or 0

        SendWebhook({
            ["embeds"] = {{
                ["color"] = 14418175,
                ["title"] = "Player Goal Set",
                ["fields"] = {
                    {
                        ["name"] = "Username:",
                        ["value"] = "```@" .. targetPlayer.Name .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "UserID:",
                        ["value"] = "```" .. targetPlayer.UserId .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Goal Amount:",
                        ["value"] = "```$" .. tostring(goalAmount) .. "```",
                        ["inline"] = true
                    }
                }
            }},
            ["components"] = {}
        })
    end

    getgenv().AddGoalLog = function(targetPlayer, goalValue, earnedSoFar)
        SendWebhook({
            ["embeds"] = {{
                ["color"] = 33535,
                ["title"] = "Player Goal Reached",
                ["fields"] = {
                    {
                        ["name"] = "Username:",
                        ["value"] = "```@" .. targetPlayer.Name .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "UserID:",
                        ["value"] = "```" .. targetPlayer.UserId .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Earned:",
                        ["value"] = "```$" .. tostring(earnedSoFar) .. "```",
                        ["inline"] = true
                    }
                }
            }},
            ["components"] = {}
        })
    end
end

function UILib:AddStats(name, decalID)
    local tab = self:AddTab(name, decalID)
    local Players = game:GetService("Players")

    local function formatNumberWithDots(number)
        local formatted = tostring(math.floor(number))
        while true do
            formatted, k = string.gsub(formatted, "^(-?%d+)(%d%d%d)", "%1.%2")
            if k == 0 then break end
        end
        return formatted
    end

    local screenFrame = Instance.new("Frame")
    screenFrame.Parent = tab.contentFrame
    screenFrame.Size = UDim2.new(1, 0, 1, -50)
    screenFrame.Position = UDim2.new(0, 0, 0, 50)
    screenFrame.BackgroundTransparency = 1

    local function createStatFrame(titleText, color1, color2)
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(0, 200, 0, 80)
        frame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
        frame.BorderSizePixel = 0
        Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

        local frameStroke = Instance.new("UIStroke", frame)
        frameStroke.Color = Color3.fromRGB(75, 45, 105)
        frameStroke.Thickness = 1
        frameStroke.Transparency = 0.4

        local shadow = Instance.new("ImageLabel")
        shadow.Name = "Shadow"
        shadow.Parent = frame
        shadow.AnchorPoint = Vector2.new(0.5, 0.5)
        shadow.Position = UDim2.new(0.5, 0, 0.5, 6)
        shadow.Size = UDim2.new(1, 15, 1, 15)
        shadow.BackgroundTransparency = 1
        shadow.Image = "rbxassetid://1316045217"
        shadow.ImageColor3 = Color3.fromRGB(60, 20, 100)
        shadow.ImageTransparency = 0.5
        shadow.ZIndex = -1
        shadow.ScaleType = Enum.ScaleType.Slice
        shadow.SliceCenter = Rect.new(10, 10, 118, 118)

        local title = Instance.new("TextLabel")
        title.Parent = frame
        title.BackgroundTransparency = 1
        title.Position = UDim2.new(0.07, 0, 0.1, 0)
        title.Size = UDim2.new(0.85, 0, 0, 24)
        title.Font = Enum.Font.GothamBold
        title.Text = titleText
        title.TextColor3 = Color3.fromRGB(255, 255, 255)
        title.TextScaled = true
        title.TextWrapped = true

        local grad = Instance.new("UIGradient")
        grad.Color = ColorSequence.new({ColorSequenceKeypoint.new(0, color1), ColorSequenceKeypoint.new(1, color2)})
        grad.Rotation = -90
        grad.Parent = title

        local valueLabel = Instance.new("TextLabel")
        valueLabel.Parent = frame
        valueLabel.BackgroundTransparency = 1
        valueLabel.Position = UDim2.new(0.1, 0, 0.55, 0)
        valueLabel.Size = UDim2.new(0.8, 0, 0, 27)
        valueLabel.Font = Enum.Font.GothamBold
        valueLabel.Text = "$0"
        valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        valueLabel.TextScaled = true
        valueLabel.TextWrapped = true

        frame.Parent = screenFrame
        return frame, valueLabel
    end

    local stockFrame, stockLabel = createStatFrame("Alts Stock:", Color3.fromRGB(38, 255, 0), Color3.fromRGB(255, 255, 255))
    local bountyFrame, bountyLabel = createStatFrame("Alts Bounty:", Color3.fromRGB(255, 0, 0), Color3.fromRGB(255, 255, 255))
    local totalAltsFrame, totalAltsLabel = createStatFrame("Total Alts:", Color3.fromRGB(0, 115, 255), Color3.fromRGB(255, 255, 255))
    local buyersFrame, buyersLabel = createStatFrame("Total Buyers:", Color3.fromRGB(251, 255, 0), Color3.fromRGB(255, 255, 255))

    stockFrame.Position = UDim2.new(0.25, -100, 0.03, 0)
    bountyFrame.Position = UDim2.new(0.75, -100, 0.03, 0)
    totalAltsFrame.Position = UDim2.new(0.25, -100, 0.35, 0)
    buyersFrame.Position = UDim2.new(0.75, -100, 0.35, 0)

    task.spawn(function()
        while task.wait(1) do
            local buyersCount = 0
            local altStock = 0
            local totalAlts = 0
            local totalBounty = 0

            for _, player in ipairs(Players:GetPlayers()) do
                local isAlt = false
                for _, altId in ipairs(getgenv().Settings.Alts.IDs or {}) do
                    if player.UserId == altId then
                        isAlt = true
                        totalAlts += 1
                        local dataFolder = player:FindFirstChild("DataFolder")
                        local currency = dataFolder and dataFolder:FindFirstChild("Currency")
                        if currency then altStock += currency.Value end
                        local leaderstats = player:FindFirstChild("leaderstats")
                        local wanted = leaderstats and leaderstats:FindFirstChild("Wanted")
                        if wanted then totalBounty += wanted.Value end
                        break
                    end
                end
                if not isAlt then buyersCount += 1 end
            end

            buyersCount = math.max(buyersCount - 1, 0)
            buyersLabel.Text = tostring(buyersCount)
            stockLabel.Text = "$" .. formatNumberWithDots(altStock)
            totalAltsLabel.Text = tostring(totalAlts)
            bountyLabel.Text = formatNumberWithDots(totalBounty)
        end
    end)
end

function UILib:AddLogs(name, decalID)
    local tab = self:AddTab(name, decalID)
    local Players = game:GetService("Players")
    local TweenService = game:GetService("TweenService")
    local Lighting = game:GetService("Lighting")

    local scrollingFrame = Instance.new("ScrollingFrame")
    scrollingFrame.Parent = tab.contentFrame
    scrollingFrame.Size = UDim2.new(1, 0, 1, -40)
    scrollingFrame.Position = UDim2.new(0, 0, 0, 30)
    scrollingFrame.BackgroundTransparency = 1
    scrollingFrame.ScrollBarThickness = 4
    scrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 50, 150)
    scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollingFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y

    local listLayout = Instance.new("UIListLayout", scrollingFrame)
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Padding = UDim.new(0, 10)
    listLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    local padding = Instance.new("UIPadding", scrollingFrame)
    padding.PaddingTop = UDim.new(0, 3)

    local function createProofPopup(player, goalAmount, finalAmount)
        local playerGui = Players.LocalPlayer:WaitForChild("PlayerGui")

        local blur = Instance.new("BlurEffect")
        blur.Size = 16
        blur.Parent = Lighting

        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "ProofPopupGui"
        screenGui.IgnoreGuiInset = true
        screenGui.ResetOnSpawn = false
        screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global
        screenGui.Parent = playerGui

        local popup = Instance.new("Frame")
        popup.Parent = screenGui
        popup.Size = UDim2.new(0, 300, 0, 100)
        popup.Position = UDim2.new(0.5, -150, 0.5, -60)
        popup.BackgroundColor3 = Color3.fromRGB(25, 18, 35)
        popup.BorderSizePixel = 0
        popup.Active = true
        popup.Draggable = false
        popup.BackgroundTransparency = 1
        popup.ZIndex = 1000

        Instance.new("UICorner", popup).CornerRadius = UDim.new(0, 12)

        local popupStroke = Instance.new("UIStroke", popup)
        popupStroke.Color = Color3.fromRGB(80, 50, 120)
        popupStroke.Thickness = 1
        popupStroke.Transparency = 0.4

        local shadow = Instance.new("ImageLabel")
        shadow.Name = "Shadow"
        shadow.Parent = popup
        shadow.AnchorPoint = Vector2.new(0.5, 0.5)
        shadow.Position = UDim2.new(0.5, 0, 0.5, 4)
        shadow.Size = UDim2.new(1, 18, 1, 18)
        shadow.BackgroundTransparency = 1
        shadow.Image = "rbxassetid://1316045217"
        shadow.ImageColor3 = Color3.fromRGB(60, 20, 100)
        shadow.ImageTransparency = 0.7
        shadow.ZIndex = 0

        task.spawn(function()
            for i = 1, 10 do
                popup.BackgroundTransparency = 1 - (i / 10)
                task.wait(0.02)
            end
        end)

        local close = Instance.new("TextButton")
        close.Parent = popup
        close.Size = UDim2.new(0, 20, 0, 20)
        close.Position = UDim2.new(1, -32, 0, 8)
        close.BackgroundColor3 = Color3.fromRGB(255, 50, 80)
        close.Text = "X"
        close.Font = Enum.Font.GothamBold
        close.TextColor3 = Color3.new(1, 1, 1)
        close.TextSize = 14
        close.ZIndex = 1001
        Instance.new("UICorner", close).CornerRadius = UDim.new(1, 0)

        local avatar = Instance.new("ImageLabel")
        avatar.Parent = popup
        avatar.Size = UDim2.new(0, 48, 0, 48)
        avatar.Position = UDim2.new(0, 16, 0, 36)
        avatar.BackgroundTransparency = 1
        avatar.ZIndex = 1001
        Instance.new("UICorner", avatar).CornerRadius = UDim.new(1, 0)

        task.spawn(function()
            local ok, img = pcall(function()
                return Players:GetUserThumbnailAsync(player.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
            end)
            avatar.Image = ok and img or "rbxasset://textures/ui/GuiImagePlaceholder.png"
        end)

        local title = Instance.new("TextLabel")
        title.Parent = popup
        title.BackgroundTransparency = 1
        title.Position = UDim2.new(0, 16, 0, 8)
        title.Size = UDim2.new(1, -32, 0, 24)
        title.Font = Enum.Font.GothamBold
        title.Text = "Goal Reached!"
        title.TextColor3 = Color3.fromRGB(180, 130, 255)
        title.TextSize = 18
        title.TextXAlignment = Enum.TextXAlignment.Left
        title.ZIndex = 1001

        local divider = Instance.new("Frame")
        divider.Parent = popup
        divider.Position = UDim2.new(0, 14, 0, 34)
        divider.Size = UDim2.new(1, -28, 0, 1)
        divider.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        divider.BackgroundTransparency = 0.85
        divider.BorderSizePixel = 0
        divider.ZIndex = 1001

        local nameLabel = Instance.new("TextLabel")
        nameLabel.Parent = popup
        nameLabel.Position = UDim2.new(0, 76, 0, 38)
        nameLabel.Size = UDim2.new(1, -100, 0, 22)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = "@" .. player.Name
        nameLabel.Font = Enum.Font.GothamBold
        nameLabel.TextSize = 20
        nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        nameLabel.ZIndex = 1001

        local goalLabel = Instance.new("TextLabel")
        goalLabel.Parent = popup
        goalLabel.Position = UDim2.new(0, 76, 0, 62)
        goalLabel.Size = UDim2.new(1, -100, 0, 22)
        goalLabel.BackgroundTransparency = 1
        goalLabel.Text = "$" .. tostring(finalAmount) .. " / $" .. tostring(goalAmount)
        goalLabel.Font = Enum.Font.Gotham
        goalLabel.TextSize = 17
        goalLabel.TextColor3 = Color3.fromRGB(120, 255, 180)
        goalLabel.TextXAlignment = Enum.TextXAlignment.Left
        goalLabel.ZIndex = 1001

        close.MouseButton1Click:Connect(function()
            task.spawn(function()
                for i = 1, 10 do
                    popup.BackgroundTransparency = i / 10
                    task.wait(0.02)
                end
                blur:Destroy()
                screenGui:Destroy()
            end)
        end)
    end

    local function createLog(actionType, player, goalAmount, finalAmount)
        local username = player.Name
        local userId = player.UserId

        local outlineColor
        local messageText

        if actionType == "join" then
            outlineColor = Color3.fromRGB(72, 255, 0)
            messageText = "@" .. username .. " joined the game!"
        elseif actionType == "rejoin" then
            outlineColor = Color3.fromRGB(229, 255, 0)
            messageText = "@" .. username .. " rejoined the game!"
        elseif actionType == "leave" then
            outlineColor = Color3.fromRGB(255, 0, 0)
            messageText = "@" .. username .. " left the game!"
        elseif actionType == "goal" then
            outlineColor = Color3.fromRGB(150, 80, 255)
            messageText = "@" .. username .. " reached their goal!"
        elseif actionType == "goalSet" then
            outlineColor = Color3.fromRGB(220, 0, 255)
            messageText = "Goal has been set for @" .. username .. "!"
        end

        local frame = Instance.new("Frame")
        frame.Parent = scrollingFrame
        frame.Size = UDim2.new(0.9, 0, 0, 40)
        frame.BackgroundColor3 = Color3.fromRGB(25, 18, 35)
        frame.BorderSizePixel = 0
        frame.ZIndex = 2
        Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 10)

        local stroke = Instance.new("UIStroke")
        stroke.Parent = frame
        stroke.Thickness = 1.5
        stroke.Color = outlineColor
        stroke.Transparency = 0.2

        local playerImage = Instance.new("ImageLabel", frame)
        playerImage.Size = UDim2.new(0, 28, 0, 28)
        playerImage.Position = UDim2.new(0, 10, 0, 6)
        playerImage.BackgroundColor3 = Color3.fromRGB(40, 28, 55)
        playerImage.BorderSizePixel = 0
        playerImage.ZIndex = 2
        playerImage.ScaleType = Enum.ScaleType.Crop
        Instance.new("UICorner", playerImage).CornerRadius = UDim.new(1, 0)

        task.spawn(function()
            local success, image = pcall(function()
                return Players:GetUserThumbnailAsync(userId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
            end)
            playerImage.Image = success and image or "rbxasset://textures/ui/GuiImagePlaceholder.png"
        end)

        local label = Instance.new("TextLabel", frame)
        label.Size = UDim2.new(1, -130, 1, 0)
        label.Position = UDim2.new(0, 50, 0, 0)
        label.BackgroundTransparency = 1
        label.Font = Enum.Font.GothamBold
        label.TextColor3 = Color3.fromRGB(255, 255, 255)
        label.TextSize = 13
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Text = messageText
        label.ZIndex = 2

        if actionType == "goal" then
            local proofBtn = Instance.new("TextButton")
            proofBtn.Parent = frame
            proofBtn.Size = UDim2.new(0, 90, 0, 24)
            proofBtn.Position = UDim2.new(1, -100, 0.5, -12)
            proofBtn.BackgroundColor3 = Color3.fromRGB(60, 40, 85)
            proofBtn.Font = Enum.Font.GothamBold
            proofBtn.TextColor3 = Color3.new(1, 1, 1)
            proofBtn.TextSize = 12
            proofBtn.Text = "Show Proof"
            proofBtn.ZIndex = 3
            Instance.new("UICorner", proofBtn).CornerRadius = UDim.new(0, 6)

            proofBtn.MouseButton1Click:Connect(function()
                createProofPopup(player, goalAmount, finalAmount)
            end)
        end
    end

    local lastJoinTimes = {}

    Players.PlayerAdded:Connect(function(player)
        local now = tick()
        if lastJoinTimes[player.UserId] and now - lastJoinTimes[player.UserId] < 10 then
            createLog("rejoin", player)
        else
            createLog("join", player)
        end
        lastJoinTimes[player.UserId] = now
    end)

    Players.PlayerRemoving:Connect(function(player)
        createLog("leave", player)
    end)

    function tab:AddGoalLog(player, goalAmount, finalAmount)
        createLog("goal", player, goalAmount, finalAmount)
    end

    function tab:AddGoalSetLog(player)
        createLog("goalSet", player)
    end

    return tab
end

function UILib:AddDropdown(tab, text, options, defaultOption, labelPosition, callback)
    local TweenService = game:GetService("TweenService")

    local dropdownFrame = Instance.new("Frame")
    dropdownFrame.Parent = tab.contentFrame
    dropdownFrame.Size = UDim2.new(0.9, 0, 0, 39)
    dropdownFrame.Position = UDim2.new(0.05, 0, 0, (#tab.contentFrame:GetChildren() - 1.2) * 43 + 20)
    dropdownFrame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
    dropdownFrame.BackgroundTransparency = 0
    dropdownFrame.BorderSizePixel = 0
    dropdownFrame.ZIndex = 2

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = dropdownFrame

    local frameStroke = Instance.new("UIStroke")
    frameStroke.Parent = dropdownFrame
    frameStroke.Color = Color3.fromRGB(75, 45, 105)
    frameStroke.Thickness = 1
    frameStroke.Transparency = 0.4

    local label = Instance.new("TextLabel")
    label.Parent = dropdownFrame
    label.Text = text
    label.Position = UDim2.new(0.05, 0, 0, 0)
    label.Size = UDim2.new(0.65, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextYAlignment = Enum.TextYAlignment.Center
    label.RichText = true
    label.ZIndex = 3
    label.ClipsDescendants = true

    local dropdownButton = Instance.new("TextButton")
    dropdownButton.Parent = dropdownFrame
    dropdownButton.Size = UDim2.new(0.25, 0, 0.8, 0)
    dropdownButton.Position = UDim2.new(0.72, 0, 0.1, 0)
    dropdownButton.BackgroundColor3 = Color3.fromRGB(45, 32, 62)
    dropdownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    dropdownButton.Text = defaultOption or "Select"
    dropdownButton.TextXAlignment = Enum.TextXAlignment.Center
    dropdownButton.TextYAlignment = Enum.TextYAlignment.Center
    dropdownButton.Font = Enum.Font.GothamBold
    dropdownButton.TextSize = 15
    dropdownButton.BorderSizePixel = 0
    dropdownButton.ZIndex = 4
    dropdownButton.AutoButtonColor = false

    local dropdownCorner = Instance.new("UICorner")
    dropdownCorner.CornerRadius = UDim.new(0, 10)
    dropdownCorner.Parent = dropdownButton

    local dropBtnStroke = Instance.new("UIStroke", dropdownButton)
    dropBtnStroke.Color = Color3.fromRGB(90, 55, 130)
    dropBtnStroke.Thickness = 1
    dropBtnStroke.Transparency = 0.5

    local dropdownList = Instance.new("ScrollingFrame")
    dropdownList.Parent = dropdownFrame
    dropdownList.Visible = false
    dropdownList.Size = UDim2.new(1, 0, 0, 0)
    dropdownList.Position = UDim2.new(0, 0, 1, 0)
    dropdownList.BackgroundColor3 = Color3.fromRGB(25, 18, 35)
    dropdownList.BorderSizePixel = 0
    dropdownList.CanvasSize = UDim2.new(0, 0, 0, #options * 36)
    dropdownList.ScrollBarThickness = 4
    dropdownList.ScrollBarImageColor3 = Color3.fromRGB(100, 50, 150)
    dropdownList.ZIndex = 5

    local dropdownCorner2 = Instance.new("UICorner")
    dropdownCorner2.CornerRadius = UDim.new(0, 12)
    dropdownCorner2.Parent = dropdownList

    local listLayout = Instance.new("UIListLayout")
    listLayout.Parent = dropdownList
    listLayout.Padding = UDim.new(0, 5)

    for _, option in ipairs(options) do
        local optionButton = Instance.new("TextButton")
        optionButton.Parent = dropdownList
        optionButton.Text = option
        optionButton.TextXAlignment = Enum.TextXAlignment.Center
        optionButton.TextYAlignment = Enum.TextYAlignment.Center
        optionButton.Size = UDim2.new(1, -8, 0, 30)
        optionButton.Position = UDim2.new(0, 4, 0, 0)
        optionButton.BackgroundColor3 = Color3.fromRGB(40, 28, 55)
        optionButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        optionButton.Font = Enum.Font.GothamBold
        optionButton.TextSize = 14
        optionButton.BorderSizePixel = 0
        optionButton.ZIndex = 6
        optionButton.AutoButtonColor = false

        local opCorner = Instance.new("UICorner")
        opCorner.CornerRadius = UDim.new(0, 10)
        opCorner.Parent = optionButton

        local opStroke = Instance.new("UIStroke")
        opStroke.Parent = optionButton
        opStroke.Color = Color3.fromRGB(75, 45, 105)
        opStroke.Thickness = 1
        opStroke.Transparency = 0.6

        optionButton.MouseEnter:Connect(function()
            TweenService:Create(optionButton, TweenInfo.new(0.12), { BackgroundColor3 = Color3.fromRGB(55, 38, 75) }):Play()
        end)

        optionButton.MouseLeave:Connect(function()
            TweenService:Create(optionButton, TweenInfo.new(0.12), { BackgroundColor3 = Color3.fromRGB(40, 28, 55) }):Play()
        end)

        optionButton.MouseButton1Click:Connect(function()
            dropdownButton.Text = option
            TweenService:Create(dropdownList, TweenInfo.new(0.2), { Size = UDim2.new(1, 0, 0, 0) }):Play()
            task.wait(0.1)
            dropdownList.Visible = false
            callback(option)
        end)
    end

    dropdownButton.MouseEnter:Connect(function()
        TweenService:Create(dropdownButton, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(60, 42, 82)}):Play()
    end)
    dropdownButton.MouseLeave:Connect(function()
        TweenService:Create(dropdownButton, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(45, 32, 62)}):Play()
    end)

    dropdownButton.MouseButton1Click:Connect(function()
        if dropdownList.Visible then
            TweenService:Create(dropdownList, TweenInfo.new(0.2), { Size = UDim2.new(1, 0, 0, 0) }):Play()
            task.wait(0.1)
            dropdownList.Visible = false
        else
            dropdownList.Visible = true
            local targetHeight = math.min(#options, 4) * 36 + 6
            TweenService:Create(dropdownList, TweenInfo.new(0.25), { Size = UDim2.new(1, 0, 0, targetHeight) }):Play()
        end
    end)

    tab.contentFrame.CanvasSize = UDim2.new(0, 0, 0, (#tab.contentFrame:GetChildren()) * 50)

    return dropdownButton
end

function UILib:AddLabel(tab, text)
    local label = Instance.new("TextLabel")
    label.Parent = tab.contentFrame
    label.Text = text
    label.Size = UDim2.new(0.9, 0, 0, 36)
    label.Position = UDim2.new(0.05, 0, 0, (#tab.contentFrame:GetChildren() - 1.2) * 43 + 20)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(180, 140, 220)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    tab.contentFrame.CanvasSize = UDim2.new(0, 0, 0, (#tab.contentFrame:GetChildren()) * 50)
    return label
end

function UILib:AddKeybind(tab, text, callback, defaultKey)
    local TweenService = game:GetService("TweenService")
    
    local keybindFrame = Instance.new("Frame")
    keybindFrame.Parent = tab.contentFrame
    keybindFrame.Size = UDim2.new(0.9, 0, 0, 39)
    keybindFrame.Position = UDim2.new(0.05, 0, 0, (#tab.contentFrame:GetChildren() - 1.2) * 43 + 20)
    keybindFrame.BackgroundColor3 = Color3.fromRGB(28, 20, 38)
    keybindFrame.BackgroundTransparency = 0
    keybindFrame.BorderSizePixel = 0

    local stroke = Instance.new("UIStroke")
    stroke.Parent = keybindFrame
    stroke.Color = Color3.fromRGB(75, 45, 105)
    stroke.Thickness = 1
    stroke.Transparency = 0.4

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = keybindFrame

    local label = Instance.new("TextLabel")
    label.Parent = keybindFrame
    label.Text = text
    label.Size = UDim2.new(0.5, 0, 1, 0) 
    label.Position = UDim2.new(0.2, 0, 0, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    label.TextXAlignment = Enum.TextXAlignment.Center

    local keybindButton = Instance.new("TextButton")
    keybindButton.Parent = keybindFrame
    keybindButton.Text = defaultKey and defaultKey.Name or "..."
    keybindButton.Size = UDim2.new(0.25, 0, 0.8, 0) 
    keybindButton.Position = UDim2.new(0.73, 0, 0.1, 0)
    keybindButton.BackgroundColor3 = Color3.fromRGB(45, 32, 62)
    keybindButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    keybindButton.Font = Enum.Font.GothamBold
    keybindButton.TextSize = 16
    keybindButton.BorderSizePixel = 0
    keybindButton.TextXAlignment = Enum.TextXAlignment.Center
    keybindButton.AutoButtonColor = false

    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = keybindButton

    local buttonStroke = Instance.new("UIStroke")
    buttonStroke.Parent = keybindButton
    buttonStroke.Color = Color3.fromRGB(90, 55, 130)
    buttonStroke.Thickness = 1
    buttonStroke.Transparency = 0.5

    keybindButton.MouseEnter:Connect(function()
        TweenService:Create(keybindButton, TweenInfo.new(0.15), { BackgroundColor3 = Color3.fromRGB(60, 42, 82) }):Play()
    end)
    
    keybindButton.MouseLeave:Connect(function()
        TweenService:Create(keybindButton, TweenInfo.new(0.15), { BackgroundColor3 = Color3.fromRGB(45, 32, 62) }):Play()
    end)

    local keybind = defaultKey or nil
    local waitingForKey = false

    keybindButton.MouseButton1Click:Connect(function()
        if not waitingForKey then
            keybindButton.Text = "..."
            waitingForKey = true
        else
            keybindButton.Text = keybind and keybind.Name or "..."
            waitingForKey = false
        end
    end)

    local UIS = game:GetService("UserInputService")
    UIS.InputBegan:Connect(function(input, gameProcessed)
        if waitingForKey and input.UserInputType == Enum.UserInputType.Keyboard then
            keybind = input.KeyCode
            keybindButton.Text = keybind.Name
            waitingForKey = false
            callback(keybind)
        elseif not gameProcessed and input.UserInputType == Enum.UserInputType.Keyboard then
            if keybind and input.KeyCode == keybind then
                callback(keybind)
            end
        end
    end)

    tab.contentFrame.CanvasSize = UDim2.new(0, 0, 0, (#tab.contentFrame:GetChildren()) * 43.9)

    return keybindButton
end

return UILib
